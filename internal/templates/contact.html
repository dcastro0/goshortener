{{define "contact"}}
{{template "base" .}}
{{end}}

{{define "content"}}
<div class="glass rounded-2xl p-8 shadow-2xl ring-1 ring-white/10 relative overflow-hidden" 
     x-data="{
        name: '',
        email: '',
        subject: 'DÃºvida Geral',
        message: '',
        loading: false,
        success: false,
        error: null,

        async sendMessage() {
            this.loading = true;
            this.error = null;
            this.success = false;

            try {
                const res = await fetch('/contact', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: this.name,
                        email: this.email,
                        subject: this.subject,
                        message: this.message
                    })
                });

                const data = await res.json();

                if (!res.ok) throw new Error(data.error || 'Erro ao enviar');

                this.success = true;
                this.name = '';
                this.email = '';
                this.message = '';
            } catch (e) {
                this.error = e.message;
            } finally {
                this.loading = false;
            }
        }
     }">
    
    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-500 to-pink-500"></div>

    <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl font-bold text-white">ðŸ“¬ Fale Conosco</h2>
        <a href="/" class="px-4 py-2 rounded-lg bg-slate-800/50 hover:bg-slate-700 border border-slate-700 text-sm text-slate-300 transition-all hover:text-white flex items-center gap-2">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
            Voltar
        </a>
    </div>

    <form @submit.prevent="sendMessage" class="flex flex-col gap-4" x-show="!success" x-transition>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-1">Seu Nome</label>
                <input type="text" x-model="name" required class="w-full px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-white transition">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-300 mb-1">Seu Email</label>
                <input type="email" x-model="email" required class="w-full px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-white transition">
            </div>
        </div>

        <div>
            <label class="block text-sm font-medium text-gray-300 mb-1">Assunto</label>
            <select x-model="subject" class="w-full px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-white transition">
                <option>DÃºvida Geral</option>
                <option>Reportar Link Abusivo</option>
                <option>Parceria Comercial</option>
                <option>Suporte TÃ©cnico</option>
            </select>
        </div>

        <div>
            <label class="block text-sm font-medium text-gray-300 mb-1">Mensagem</label>
            <textarea x-model="message" rows="4" required class="w-full px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-lg focus:ring-2 focus:ring-purple-500 outline-none text-white transition resize-none"></textarea>
        </div>

        <div x-show="error" class="text-red-400 text-sm bg-red-400/10 p-3 rounded border border-red-400/20" x-text="error"></div>

        <button type="submit" :disabled="loading" class="w-full py-3 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-bold rounded-xl shadow-lg transition mt-2 disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-2">
            <span x-show="loading" class="animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"></span>
            <span x-text="loading ? 'Enviando...' : 'Enviar Mensagem'"></span>
        </button>
    </form>

    <div x-show="success" x-transition class="text-center py-12">
        <div class="w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-4 text-green-400">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
        </div>
        <h3 class="text-2xl font-bold text-white mb-2">Mensagem Enviada!</h3>
        <p class="text-slate-400 mb-6">Obrigado pelo contato. Responderemos em breve.</p>
        <button @click="success = false" class="text-purple-400 hover:text-purple-300 underline text-sm">Enviar outra mensagem</button>
    </div>
</div>
{{end}}